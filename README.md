# CourseWorkRevitAPI

<h1>Задание на Курсовую работу:</h1>

<b><i>\"Классы для работы с ожидаемыми параметрами\"</i></b>

Часто возникает ситуация, когда для работы плагина необходимо наличие в проекте некоторого общего параметра (например, для сохранения результатов работы плагина). Иногда имя этого параметра меняется, и в этом случае плагин перестаёт работать. Похожая ситуация может возникать и с семействами, с типоразмерами и с параметрами семейств. 

<h2>Задача 1:</h2>
Необходимо создать:
<ul>
  <li> простую диалоговую форму, в которой пользователь сможет выбирать один из существующих параметров для элементов заданной категории;</li>
<li> набор классов, который будет получать на входе ожидаемое имя параметра, тип данных параметра, параметр типа/параметр экземпляра, и осуществлять поиск подходящего параметра из любого места кода и возвращение его в качестве экземпляра класса Parameter. Если подходящий параметр не найден, то должно создаваться сообщение об ошибке и предложение пользователю создать недостающий параметр.</li>
  </ul>
  
  <h3>Подробнее:</h3>
  
  На форме разместить:
  <ul>
    <li>комбобокс для выбора категории для поиска параметра
    <li>листбокс, в котором будут отображаться доступные для категории параметры. 
    <li>кнопку, при нажатии на которую будет происходить создание параметра на основе файла общих параметров.
  </ul>
    
>За праметры отвечают классы `ShareParameterElement` и `ParameterElement`
>Если параметр существует без привязки к категории то мы его не увидим.
>За привязки отвечает специальный класс `BindingMap`.
>Файл общих параметров (ФОП) - текстовый файл (.txt) - таблица с спец. структурой. Можно найти его описание в справке Revit API Shared parameter file.
>    
><b>Например:</b><br>
>Плагин требует <i>`myParameter1`</i>. Запускаете плагин и он проверяет окружение на наличие параметра. Нет такого имени - Надо обработать. Можно проверить существует ли описание (строка в SPF). Если не существует, то "ошибка".
>    
>Запускаем плагин, если он есть - сообщение, если его нет, то тоже сообщение. 
>    
>Класс для создания параметров без учаcтия пользователя в том случае если файл описания существует. если ФОП не найден - создают >временный ФОП и добавляют в него один.

<h2>Задача 2:</h2>
Создать такой же функционал, как в задаче 1, для недостающих семейств, типоразмеров и параметров семейств.

<h3>Дополнительно</h3>

![alt text](/initial.jpg)
